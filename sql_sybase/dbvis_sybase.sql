select @@version;
select @@spid;
select @@dbts,convert(varchar(30),@@dbts),convert(bigint,@@dbts);
select hextoint(@@dbts);
select db_name();as db_used , count(1) as total_rows from TRN_HDR_DBF;

sp_help CR_CTRY_DBF; --COREPL_REP DYN_AUDIT_REP
sp_spaceused TRN_HDR_DBF, 1;
sp_helpindex INDEX_REP;
sp_helprotect TRN_HDR_DBF;
sp_helpdb GOLDEN_IMPORT_MR_MLC;
sp_helpuser;
sp_configure 'quoted';
sp_who;
sp_lock;

setuser 'MUREXDB';

set statistics time,io,plancost on;
set showplan on;
set statement_cache off;
dbcc traceon(3604,9528); -- format the output of plancost
set option show_missing_stats on;

select * from sysprocesses where spid=148;
select * from sysobjects where name like '%RPO_%'; --H399634_H1S
select * from syscolumns where id = 1309738675;
select * from sysusers where uid=2;
select db_name(), * from sysstatistics where id=(select object_id('ACC_EVTS_L_DBF'));
select db_name(), * from systabstats where id=(select object_id('ACC_EVTS_L_DBF'));
select object_id('TRN_HDR_DBF');

truncate table TRN_SECTOR_DBF;
drop table mx4284vm#27222#Z0001_TMP;
drop index TRN_HDR_DBF.TRN_HDR_SST0;
select datachange('TRN_HDR_DBF',null,null); -- this query displays the % of data changes since the last update stats, good indicator to see if update statistics should be executed.
update statistics TRN_HDR_DBF(M_PURPOSE);
create index MPY_RTC_DBF_SST0 on MPY_RTC_DBF(M_PDRVNG_PRM) with statistics using 500 values;
create table TYPO_MAP_DBF(ID int, TYPO_LABEL varchar(50));
alter table BE_STG_DBF drop M_E_DATE, M_S_DATE;


-- RDB scope SQL
select * from RDB_OBJECT_DBF where M_CLASS_NAME in ('mx.statics.dates.PayShifters','mx.statics.dates.ScheduleGenerator','mx.statics.dates.Shifter');
select * from RDB_OBJECT_DBF where M_OBJECT_ID='CM.661';
select * from RDB_CLASS_DBF where M_CLASS_NAME=(select M_CLASS_NAME from RDB_OBJECT_DBF where M_OBJECT_ID='CM.793');
select * from RDB_CLASS_DBF where M_TABLE_NAME like '%DAT_ECH_DBF%';
select M_RFG_TABLE_NAME,M_RFG_FORMULA,M_RFD_TABLE_NAME,M_RFD_FORMULA from RDBCNSTR_DBF where M_RFG_TABLE_NAME='DAT_ECH_DBF'; and M_RFG_FORMULA like 'M_REF%';
select M_RFG_TABLE_NAME,M_RFG_FORMULA,M_RFG_RELATIONSHIP,M_RFD_TABLE_NAME,M_RFD_FORMULA,M_RFD_RELATIONSHIP from RDBCNSTR_DBF where M_RFD_TABLE_NAME='TRN_GRPD_DBF'; and M_RFG_FORMULA='M_LABEL';
select 'select * from '+M_RFG_TABLE_NAME+' where '+M_RFG_FORMULA+' = 152940035;' from RDBCNSTR_DBF where M_RFD_TABLE_NAME='CR_BSKH_DBF'; and M_RFD_FORMULA='M_LABEL';
select * from RDBCNSTR_KEY_DBF where M_TABLE_NAME like 'RS_MDRSR%';

--3.1 queries
select top 10 * from TRN_PFLD_DBF where M_LABEL like '%AJUSTESWAPLP%';
update TRN_PFLD_DBF set M_LABEL='AJUSTESWAPLP',M_DSP_LABEL='AJUSTESWAPLP' where M_IDENTITY=2151;
select convert(bigint,TIMESTAMP),M_COUNTRY from CR_CTRY_DBF order by M_COUNTRY;
select count(1) from CR_CTRY_DBF where TIMESTAMP is null;
select convert(bigint,TIMESTAMP),M_REFERENCE,M_COUNTRY from CR_CTRY_DBF where M_COUNTRY='AD';
select * from CFGT_TMPL_DBF;
update USERNDX_DBF set M_DBFNAME='_INDEX' where M_IDENTITY=242;
select M_PURGE_REF, count(*)
from TRN_HDR_DBF where M_BPFOLIO in ('MX818BE','MX821BC','MX821BEBC','MX821TN','MX825HN','MX830BC','CPMDERIVA','CPMDERMN','CPCDIFWBO','CPMDIIRS','CPMSPREMX','CPCDIOTC','CPCGARENT','CPCVENCOR','CPMDENREG','CPMDIOTC','FOCSWANEG','FOMMCRO10','FOMMCRO15','FOMMCRO16','FOMMCRO18','FOMMCRO19','FOMMCRO22','FOMSWATME','FOMXEBCGL','FOMIRSMNR','FOMMCRO11','FOMMCRO14','FOMMCRO21','FOMMCRO25','FOMMCRO29','FOMMICRO2','FOMMICRO4','FOMMICRO5','FOMMICRO8','FOMMICRO9','FOMMIRSNC','FOMTEMPO','FOMXBCCGL','CVMRATES','CMMENERGY','DEMTRADIN','DGMDERIV','DGMMXEMER','DGMTASAS','DGMUDIS','LPMDIFWD','RCMDISCRE','LPMDIDEPO','LPMDIMMOO','LPMDIOTC','LPMDIRBAS','LPMIRS1','LPMIRS2','MKMDERIV','POMFX','LPMASIGNA','LPMDCCCME','LPMDCCEUR','LPMDCCINT','LPMDCCMXN','LPMDCCUSD','LPMDCNCOL','LPMDIRCUR','LPMEXDER','LPMXDERSW','MKMTRDEPO','POMIRSTIE','POMUDIMKT','POMUDIS','POCXCCY','POMINVERS','POMVALREL','POMXCCY','CRCTASAS','CRMCHL','CRMPEN','CRMTASAS','CRMTEMPO','DEMSWAPTI','DEMSWATOT','DEMVOLATI','DEMVOLTOT','ESMDIGTIE','ESMDIGTOT','ESMFLEXIC','ESMMMOO','LPMVOLTAS','LPMVOLTOT','VRMCAPCNF','VRMEXOTIC','VRMEXOTOT','DEMESTTC','DEMESTTI','ESMCOATRM','ESMDEPOS','ESMESTRMI','ESMESTRVA','ESMESTTAS','ESMWARRAN','FOMXTDCGL','FOMXTRCGL','FOXETDCGL','FOXETRCGL','AJUSTEVOLATIP','FVA_MXCRUCES','INIRDOOFF','MXCRUCDGA','MXCRUCECP','MXCRUCEDG','MXCRUCEEU','MXCRUCELP','MXCRUCENP','MXCRUCEUS','MXCRUCNPC','BANKING_BOOK','BB_ASIA','CORTO PLAZO','CORTO_PLAZO_CLI','CVA_CORTO','ETFCORTO','INIRDOCPBANK','INIRDOCPLAZO','STIR_ASIA','STIR_CNH','STIR_EUR','CRDBANCOS','CRDBTBCLP','CRDBTBCOP','CRDBTBPEN','CRDCHILE','CRDTASARS','INIRDOCRDMAD','FVA_COLATERAL','FVA_COLAT_BILAT','FVA_COLAT_CCP','FVA_LT_ASIA','FVA_RATES','FVA_RATES_ASIA','ESTRATFLOW','ESTRATGFI','INIRDOESTRAGFI','BERMUDA EUROESB','COBEXTEXO','COB_BONOS','COB_EXTERNAL','COB_EXT_TIPOS','CORTO NO BDT','FINP_COLAT_CRED','FINP_COLAT_RATE','FVA_NP_IR','INTERNAS_SABR','LEG_NPTIPOS','NP_COMMODITIES','NP_FOREX','OPCOTCBON','SLOPE_SABR','SWAPTIONAV','TRD3SPREAD','GM_GAPBONOS','GM_GAPDERIV','GM_GAPEQTY','GM_GAPWWR','SW_INI_2016','ASSET MILAN','ASSETBONOS','ASWGOB','BCAT TIPOS LARG','BGIPCAUX','BNACOBLAR','BOND OPT','BONOFW','BONOFWHD','BONOS FORWARD','BONOS_LINKERS','CDS_LARGO_PLAZO','CL LARGO','COBERPAT','CORPOIRS','CPPI_SWAPS','CVA_LARGO','DDIVIRS','ELECTRICAS','ESTRATEGIAS','ESTRATGFI_BOND','ETFDEUDA','EUROFIMA','FORWARD','FVA SWAPS','INDICES DEUDA','INIRDOLP','IRSCOMBI','IRSMEFF','IRSTRAD','IR_CINE','IR_STOCK','LATAM_SWAPS','LINKERS_ESP','LINKERS_ESP_H','LT NY','LTNY2','LT_ASIA','LT_BOND','LT_BONDH','LT_BONDT','LT_CHINA','LT_CNH','LT_HKD','LT_HKFX2','LT_HKFX_CNH','LT_HK_OPT','LT_HK_STRATEGY1','LT_KOREA','LT_KOREA_REPO','LT_KRW','LT_TWD','MACROBCLSW','MICROCOB','OPERPAT','PROFIT','PROJECT_GL_SW','STOCKPYME','SWACLIDIV','SWACLIINT','SWAPDIVCO','SWAPDIVNC','SWAPFXIRS','SWAPINTCO','SWAPINTNC','SWAPS_CVA','SWAPS_RF','SWBBVA','SWDIRFIN','SWNYBBVA','SW_BANKS','SW_CCY_BASIS','SW_COLAT_PT','SW_CORTO','SW_ELECTRONIC','SW_EQUITY','SW_GBP','SW_GERMANY','SW_INI_2015','SW_INSURANCE','SW_PASTORA','SW_TI','SW_TRADING_1','SW_TRADING_2','SW_TRADING_3','SW_TRADING_4','SW_TRADING_5','SW_TRADING_6','SW_USD','TAIWAN_FX','TAIWAN_IRS','TEMPMC02','VTABNPVMX','VTACAJAMX','XXBBVLPSW','ZZASSETSWAP','ZZMC02','ZZSWAPS','ZZUSA','FLOORSPV','CRDCLP','CRDCOP','CRDPEN','INIRDOSUDAM','MXCRUCECA','MXCRUCECL','MXCRUCECO','MXCRUCEPE','BBV BERMUDA COR','BBV CORTO','BBV CORTO MCO2','BBV DIG','BBV VANILLA','BBV VANILLAMC02','BCAT VOL INT','BDT BBV','BDT BBV MC02','BDT CORTO MC02','BDTBBV2','BDTBBV3','BERM USD COR','BERMUDA DOM','BNACOBVOL','BOND_INFLATION','CFCHIPOT','CHILENOS','CHILENOS BBVA','CL VOLAT TIPOS','CLOSE BDT BBV','CLOSE BDT MC02','COBMAXMIN','CORRELACION USD','DERCOMBI','DIG BBVA','DIG DOM','DIG EUROESB','DIGUSDBBVA','ESP-INFLATION','EUR-INFLATION','EXOTICAS','FIN98','FVA_INFLATION','FVA_VOL_RATES','HEDGEAV','HEDGEVIT','HIBRIDOS','HIPOTECRED','INIRDOVTP','LARGO NO BDT','LEGVOLATIPOS','MACROBCLVOL','OPC BONOS','OPCBDTHOJAS','OPCION COB','OPCION NC','OPCMIBOR','OPCSALES','OPTIPCFC','PROJECT_GL_VT','REVERFLFL','SWAPTION EURO','SWAPTION LARGO','SWAPTION USD','SWAPTIONUSDBBVA','TIPDIVCFC','UNNIM_VTIP','US-INFLATION','VOL ASSETSWAP','VOL-INFLATION','VOLASIA1','VOLASIA2','VOLASIA3','VOLASIA5','VOLASIA6','VOLAUD','VOLCHF','VOLCNY','VOLCNY_EXO','VOLGBP','VOLHKD','VOLHKD_2','VOLJPY','VOLKRW','VOLSGD','VOLTWD','VOLUSD','VTCBBVA','VTCBDTBBVA','VTCOPCBONOBBVA','VTCSWAPTIONBBVA','VTLBDTBBVA','VTLDIGBBVA','VTLVANILLABBVA','ZC-OPTIONS','INIRDOPD','INIRDOPD997','AAAPDFX1','AAAPDFX2','AAAPDFX3','AAAPDG01','AAAPDG02','AAAPDG04','AAAPDRV1','AAAPDRV2','AAAPDRV3','AAAPDTI1','AAAPDTI1B','AAAPDTI2','AAAPDTI3','PT_CREDITO','PT_FX','PT_RV','PT_SWAPS','ANALISTAS','G3','G3_EQUITY','INIRDOTRADSIST','LT_PROGRAM','NON_LIN_HF','UST_LOCK','UST_SPREAD','MGDSTOXAF','INIRDODISTMAD','INIRDOMIL','ASSWMIL','INIRDOOPC','INIRDODERIVNY','INIRDOUS_TREASU','NY_MANAGEMENT','NY_ST_DER','MAD_UST_BTB','UST_BOND','UST_STRAT','KOR_LT_SWAP','INIKORLT','VOL_IR_KOREA_1','INIRDOLTIRTPE','TWN_LTIRD2_DBU','TWN_VOLIR1_DBU','INIRDOVOLIRTPE','TWN_LTIRD1_DBU','LON_ESTRUCTURAS','MXCRUCDGC','INDICESG','CRDTASAS','IMVA_RATES','GM_GAPLCR','LT_HKFX1','LT_HKFX3','MGE_POS','MANAGEMENT','MANAGEMENT4','ASIACREDIT','BSI_AGENT','BSI_AGENTLAT','BSI_LATBOND','BSI_UST','CLRENTAMX','COB EST CREDITO','CORR_CREDIT','CORR_CREDIT_NM','CREXBNY','CVA_CREDITO','CVA_HEDGE_MACRO','CVA_PREMIUMS','DIVIDENDS','FINP_INFLATION','FINP_REPO','FI_EUCDS','FVA_BOOK','FVA_CREDITO','FVA_NPC','HEDGE TARN','MADLATBOND2','MAD_FINBOND','MAD_LATBOND','MAD_USBOND','MXCRUCECR','NPC_BONO','NPC_CDO','NPC_CLN','NPC_REPO','RF ASSET SWAP','RF AUTOS','RF CDS BASIS','RF CONSUMER','RF CORP FRN','RF CROSSOVERS','RF ENERGY','RF EXECUTION','RF FINANCIALS','RF INDUSTRIALS','RF JUMBOS','RF LOCAL AUTHOR','RF MILAN','RF OTC2','RF POSI','RF PREFERENTES','RF PRIVADA','RF REPOS','RF SEGUROS','RF SUPRAS','RF TELECOMS','RF UTILITIES','RF VOLATILIDAD','RFMICROHDGECORP','RF_CORP_CON','RF_CORP_INDUST','RF_CORP_UTIL','RF_FINAN_FRN','RF_FINAN_SUB','RF_FIN_NORTH','RF_FIN_SOUTH','RF_HIVOL','RF_MANAGEMENT','RF_NO_MARCO','RF_VENTAS_CORP','SECTOR INDEX','TIPOS_CREDITO','TRANCHE_T','VTC BBVA','ASIACREDIT','ASIACREUR','ASIACRUSA','CDS FINAN','CDS FINAN SUB','CLRENTAMX','CREDITO ESTRAT','CRMTRADM2','CRMTRADMX','CRMTRAUS2','CRMTRAUSD','FI_EMER','FI_EMERCDS','LATAM_BONOS','LATAM_CDS','LPCCORPOS','LPMVRPOSI','MADFINBOND2','MADHYBOND','MADLATBOND2','MADUSBOND2','MAD_FINBOND','MAD_LATBOND','MAD_LATSOV','MAD_USBOND','MANCOMITE_CDS','MXCRUCCR2','MXCRUCECR','REPOS_UST','REPOTRES MUREX','RF ASSET SWAP','RF CALLABLE','RF CDS BASIS','RF CDS FINAN','RF COIN','RF CORP FRN','RF CPPI','RF CPPI LYNX','RF CROSSOVERS','RF ENERGY','RF ESTRATEGIA','RF EXECUTION','RF FINANCIALS','RF FRN STRATEGY','RF FUTUROS','RF INDEX LINK','RF INDUSTRIALS','RF JUMBOS','RF LOCAL AUTHOR','RF MILAN','RF MILAN2','RF OTC','RF OTC2','RF POSI','RF PREFERENTES','RF PRIVADA','RF RED','RF REPOS','RF RETAIL','RF SCHULDSCHEIN','RF SECURITIZATI','RF SEGUROS','RF SUPRAS','RF VOLATILIDAD','RFMICROHDGECORP','RFMICROHDGEFIN','RF_CDO_ABS','RF_CORP_AUT','RF_CORP_CON','RF_CORP_TMT','RF_CORP_UTIL','RF_CPPI_HEDGE','RF_FINAN_FRN','RF_FINAN_SUB','RF_FIN_NORTH','RF_FIN_SOUTH','RF_HIVOL','RF_LOANS_HEDGES','RF_MANAGEMENT','RF_NO_MARCO','RF_REPOFI','RF_REVREPOFI')
or M_SPFOLIO in ('MX818BE','MX821BC','MX821BEBC','MX821TN','MX825HN','MX830BC','CPMDERIVA','CPMDERMN','CPCDIFWBO','CPMDIIRS','CPMSPREMX','CPCDIOTC','CPCGARENT','CPCVENCOR','CPMDENREG','CPMDIOTC','FOCSWANEG','FOMMCRO10','FOMMCRO15','FOMMCRO16','FOMMCRO18','FOMMCRO19','FOMMCRO22','FOMSWATME','FOMXEBCGL','FOMIRSMNR','FOMMCRO11','FOMMCRO14','FOMMCRO21','FOMMCRO25','FOMMCRO29','FOMMICRO2','FOMMICRO4','FOMMICRO5','FOMMICRO8','FOMMICRO9','FOMMIRSNC','FOMTEMPO','FOMXBCCGL','CVMRATES','CMMENERGY','DEMTRADIN','DGMDERIV','DGMMXEMER','DGMTASAS','DGMUDIS','LPMDIFWD','RCMDISCRE','LPMDIDEPO','LPMDIMMOO','LPMDIOTC','LPMDIRBAS','LPMIRS1','LPMIRS2','MKMDERIV','POMFX','LPMASIGNA','LPMDCCCME','LPMDCCEUR','LPMDCCINT','LPMDCCMXN','LPMDCCUSD','LPMDCNCOL','LPMDIRCUR','LPMEXDER','LPMXDERSW','MKMTRDEPO','POMIRSTIE','POMUDIMKT','POMUDIS','POCXCCY','POMINVERS','POMVALREL','POMXCCY','CRCTASAS','CRMCHL','CRMPEN','CRMTASAS','CRMTEMPO','DEMSWAPTI','DEMSWATOT','DEMVOLATI','DEMVOLTOT','ESMDIGTIE','ESMDIGTOT','ESMFLEXIC','ESMMMOO','LPMVOLTAS','LPMVOLTOT','VRMCAPCNF','VRMEXOTIC','VRMEXOTOT','DEMESTTC','DEMESTTI','ESMCOATRM','ESMDEPOS','ESMESTRMI','ESMESTRVA','ESMESTTAS','ESMWARRAN','FOMXTDCGL','FOMXTRCGL','FOXETDCGL','FOXETRCGL','AJUSTEVOLATIP','FVA_MXCRUCES','INIRDOOFF','MXCRUCDGA','MXCRUCECP','MXCRUCEDG','MXCRUCEEU','MXCRUCELP','MXCRUCENP','MXCRUCEUS','MXCRUCNPC','BANKING_BOOK','BB_ASIA','CORTO PLAZO','CORTO_PLAZO_CLI','CVA_CORTO','ETFCORTO','INIRDOCPBANK','INIRDOCPLAZO','STIR_ASIA','STIR_CNH','STIR_EUR','CRDBANCOS','CRDBTBCLP','CRDBTBCOP','CRDBTBPEN','CRDCHILE','CRDTASARS','INIRDOCRDMAD','FVA_COLATERAL','FVA_COLAT_BILAT','FVA_COLAT_CCP','FVA_LT_ASIA','FVA_RATES','FVA_RATES_ASIA','ESTRATFLOW','ESTRATGFI','INIRDOESTRAGFI','BERMUDA EUROESB','COBEXTEXO','COB_BONOS','COB_EXTERNAL','COB_EXT_TIPOS','CORTO NO BDT','FINP_COLAT_CRED','FINP_COLAT_RATE','FVA_NP_IR','INTERNAS_SABR','LEG_NPTIPOS','NP_COMMODITIES','NP_FOREX','OPCOTCBON','SLOPE_SABR','SWAPTIONAV','TRD3SPREAD','GM_GAPBONOS','GM_GAPDERIV','GM_GAPEQTY','GM_GAPWWR','SW_INI_2016','ASSET MILAN','ASSETBONOS','ASWGOB','BCAT TIPOS LARG','BGIPCAUX','BNACOBLAR','BOND OPT','BONOFW','BONOFWHD','BONOS FORWARD','BONOS_LINKERS','CDS_LARGO_PLAZO','CL LARGO','COBERPAT','CORPOIRS','CPPI_SWAPS','CVA_LARGO','DDIVIRS','ELECTRICAS','ESTRATEGIAS','ESTRATGFI_BOND','ETFDEUDA','EUROFIMA','FORWARD','FVA SWAPS','INDICES DEUDA','INIRDOLP','IRSCOMBI','IRSMEFF','IRSTRAD','IR_CINE','IR_STOCK','LATAM_SWAPS','LINKERS_ESP','LINKERS_ESP_H','LT NY','LTNY2','LT_ASIA','LT_BOND','LT_BONDH','LT_BONDT','LT_CHINA','LT_CNH','LT_HKD','LT_HKFX2','LT_HKFX_CNH','LT_HK_OPT','LT_HK_STRATEGY1','LT_KOREA','LT_KOREA_REPO','LT_KRW','LT_TWD','MACROBCLSW','MICROCOB','OPERPAT','PROFIT','PROJECT_GL_SW','STOCKPYME','SWACLIDIV','SWACLIINT','SWAPDIVCO','SWAPDIVNC','SWAPFXIRS','SWAPINTCO','SWAPINTNC','SWAPS_CVA','SWAPS_RF','SWBBVA','SWDIRFIN','SWNYBBVA','SW_BANKS','SW_CCY_BASIS','SW_COLAT_PT','SW_CORTO','SW_ELECTRONIC','SW_EQUITY','SW_GBP','SW_GERMANY','SW_INI_2015','SW_INSURANCE','SW_PASTORA','SW_TI','SW_TRADING_1','SW_TRADING_2','SW_TRADING_3','SW_TRADING_4','SW_TRADING_5','SW_TRADING_6','SW_USD','TAIWAN_FX','TAIWAN_IRS','TEMPMC02','VTABNPVMX','VTACAJAMX','XXBBVLPSW','ZZASSETSWAP','ZZMC02','ZZSWAPS','ZZUSA','FLOORSPV','CRDCLP','CRDCOP','CRDPEN','INIRDOSUDAM','MXCRUCECA','MXCRUCECL','MXCRUCECO','MXCRUCEPE','BBV BERMUDA COR','BBV CORTO','BBV CORTO MCO2','BBV DIG','BBV VANILLA','BBV VANILLAMC02','BCAT VOL INT','BDT BBV','BDT BBV MC02','BDT CORTO MC02','BDTBBV2','BDTBBV3','BERM USD COR','BERMUDA DOM','BNACOBVOL','BOND_INFLATION','CFCHIPOT','CHILENOS','CHILENOS BBVA','CL VOLAT TIPOS','CLOSE BDT BBV','CLOSE BDT MC02','COBMAXMIN','CORRELACION USD','DERCOMBI','DIG BBVA','DIG DOM','DIG EUROESB','DIGUSDBBVA','ESP-INFLATION','EUR-INFLATION','EXOTICAS','FIN98','FVA_INFLATION','FVA_VOL_RATES','HEDGEAV','HEDGEVIT','HIBRIDOS','HIPOTECRED','INIRDOVTP','LARGO NO BDT','LEGVOLATIPOS','MACROBCLVOL','OPC BONOS','OPCBDTHOJAS','OPCION COB','OPCION NC','OPCMIBOR','OPCSALES','OPTIPCFC','PROJECT_GL_VT','REVERFLFL','SWAPTION EURO','SWAPTION LARGO','SWAPTION USD','SWAPTIONUSDBBVA','TIPDIVCFC','UNNIM_VTIP','US-INFLATION','VOL ASSETSWAP','VOL-INFLATION','VOLASIA1','VOLASIA2','VOLASIA3','VOLASIA5','VOLASIA6','VOLAUD','VOLCHF','VOLCNY','VOLCNY_EXO','VOLGBP','VOLHKD','VOLHKD_2','VOLJPY','VOLKRW','VOLSGD','VOLTWD','VOLUSD','VTCBBVA','VTCBDTBBVA','VTCOPCBONOBBVA','VTCSWAPTIONBBVA','VTLBDTBBVA','VTLDIGBBVA','VTLVANILLABBVA','ZC-OPTIONS','INIRDOPD','INIRDOPD997','AAAPDFX1','AAAPDFX2','AAAPDFX3','AAAPDG01','AAAPDG02','AAAPDG04','AAAPDRV1','AAAPDRV2','AAAPDRV3','AAAPDTI1','AAAPDTI1B','AAAPDTI2','AAAPDTI3','PT_CREDITO','PT_FX','PT_RV','PT_SWAPS','ANALISTAS','G3','G3_EQUITY','INIRDOTRADSIST','LT_PROGRAM','NON_LIN_HF','UST_LOCK','UST_SPREAD','MGDSTOXAF','INIRDODISTMAD','INIRDOMIL','ASSWMIL','INIRDOOPC','INIRDODERIVNY','INIRDOUS_TREASU','NY_MANAGEMENT','NY_ST_DER','MAD_UST_BTB','UST_BOND','UST_STRAT','KOR_LT_SWAP','INIKORLT','VOL_IR_KOREA_1','INIRDOLTIRTPE','TWN_LTIRD2_DBU','TWN_VOLIR1_DBU','INIRDOVOLIRTPE','TWN_LTIRD1_DBU','LON_ESTRUCTURAS','MXCRUCDGC','INDICESG','CRDTASAS','IMVA_RATES','GM_GAPLCR','LT_HKFX1','LT_HKFX3','MGE_POS','MANAGEMENT','MANAGEMENT4','ASIACREDIT','BSI_AGENT','BSI_AGENTLAT','BSI_LATBOND','BSI_UST','CLRENTAMX','COB EST CREDITO','CORR_CREDIT','CORR_CREDIT_NM','CREXBNY','CVA_CREDITO','CVA_HEDGE_MACRO','CVA_PREMIUMS','DIVIDENDS','FINP_INFLATION','FINP_REPO','FI_EUCDS','FVA_BOOK','FVA_CREDITO','FVA_NPC','HEDGE TARN','MADLATBOND2','MAD_FINBOND','MAD_LATBOND','MAD_USBOND','MXCRUCECR','NPC_BONO','NPC_CDO','NPC_CLN','NPC_REPO','RF ASSET SWAP','RF AUTOS','RF CDS BASIS','RF CONSUMER','RF CORP FRN','RF CROSSOVERS','RF ENERGY','RF EXECUTION','RF FINANCIALS','RF INDUSTRIALS','RF JUMBOS','RF LOCAL AUTHOR','RF MILAN','RF OTC2','RF POSI','RF PREFERENTES','RF PRIVADA','RF REPOS','RF SEGUROS','RF SUPRAS','RF TELECOMS','RF UTILITIES','RF VOLATILIDAD','RFMICROHDGECORP','RF_CORP_CON','RF_CORP_INDUST','RF_CORP_UTIL','RF_FINAN_FRN','RF_FINAN_SUB','RF_FIN_NORTH','RF_FIN_SOUTH','RF_HIVOL','RF_MANAGEMENT','RF_NO_MARCO','RF_VENTAS_CORP','SECTOR INDEX','TIPOS_CREDITO','TRANCHE_T','VTC BBVA','ASIACREDIT','ASIACREUR','ASIACRUSA','CDS FINAN','CDS FINAN SUB','CLRENTAMX','CREDITO ESTRAT','CRMTRADM2','CRMTRADMX','CRMTRAUS2','CRMTRAUSD','FI_EMER','FI_EMERCDS','LATAM_BONOS','LATAM_CDS','LPCCORPOS','LPMVRPOSI','MADFINBOND2','MADHYBOND','MADLATBOND2','MADUSBOND2','MAD_FINBOND','MAD_LATBOND','MAD_LATSOV','MAD_USBOND','MANCOMITE_CDS','MXCRUCCR2','MXCRUCECR','REPOS_UST','REPOTRES MUREX','RF ASSET SWAP','RF CALLABLE','RF CDS BASIS','RF CDS FINAN','RF COIN','RF CORP FRN','RF CPPI','RF CPPI LYNX','RF CROSSOVERS','RF ENERGY','RF ESTRATEGIA','RF EXECUTION','RF FINANCIALS','RF FRN STRATEGY','RF FUTUROS','RF INDEX LINK','RF INDUSTRIALS','RF JUMBOS','RF LOCAL AUTHOR','RF MILAN','RF MILAN2','RF OTC','RF OTC2','RF POSI','RF PREFERENTES','RF PRIVADA','RF RED','RF REPOS','RF RETAIL','RF SCHULDSCHEIN','RF SECURITIZATI','RF SEGUROS','RF SUPRAS','RF VOLATILIDAD','RFMICROHDGECORP','RFMICROHDGEFIN','RF_CDO_ABS','RF_CORP_AUT','RF_CORP_CON','RF_CORP_TMT','RF_CORP_UTIL','RF_CPPI_HEDGE','RF_FINAN_FRN','RF_FINAN_SUB','RF_FIN_NORTH','RF_FIN_SOUTH','RF_HIVOL','RF_LOANS_HEDGES','RF_MANAGEMENT','RF_NO_MARCO','RF_REPOFI','RF_REVREPOFI')
group by M_PURGE_REF;
---- number of rows in a table
select row_count(db_id(),object_id('BE_STG_DBF'));
---- client indexes
truncate table RDBCSNDX_DBF;
select * from RDBCSNDX_DBF; where M_TABNAME like 'MPX_VOL%';
select * from RDBCSNDX_DBF where M_EXPRESSION like 'create unique clustered index%' and M_TABNAME='MPX_VOL1';
---- RichClient related SQL
select * from NON_IDPT_DBF where STEP like '%nitiali%';
delete from NON_IDPT_DBF where STEP='InitializationAll';
------ workflows initialization all
select (select count(1) from STPFC_ENTRY_TABLE) as 'Contract entries', (select count(1) from STPEVT_ENTRY_TABLE) as 'Event entries',(select count(1) from STPSI_ENTRY_TABLE) as 'Settlement entries', (select count(1) from STPDLV_ENTRY_TABLE) as 'Deliverable entries';
truncate table STPFC_ENTRY_TABLE;
truncate table STPEVT_ENTRY_TABLE;
------ get audit of migration
select MESSAGE_TIME_STAMP,PATH, STEP, GSTATUS,MX_BUILD_ID from MXODR_ASSEMBLY_LOG order by MESSAGE_ID;
---- consolidation related 
select CLASSIFICATION_KEY_P, SUB_CLASSIFICATION_KEY, TRADE_NUMBER, M_TRN_STATUS from PS_POS_EX_E ps join TRN_HDR_DBF tr on ps.TRADE_NUMBER=tr.M_NB where CLASSIFICATION_KEY_P=20834;
select M_LABEL,count(*) from SST_CONSO_TMP2 where M_LABEL in ('Bond','Bond Future','Bond Option','Callable Bond','CDS','CDS Index','Depo','FRA','FX Future','Spot','FX Swap','IR Future','IR Future Option','IRS','Repo BD','SCF','Xccy Swap') group by M_LABEL;
select typ.M_LABEL,count(*) from 
TYPOLOGY_DBF typ join CLASS_ID_DBF clas on typ.M_REFERENCE=clas.M_TYPO 
join CLASSIFICATION_KEYS_P_DBF keys on clas.M_FIN_ID=keys.M_CLASSID
where typ.M_LABEL in ('Bond','Bond Future','Bond Option','Callable Bond','CDS','CDS Index','Depo','FRA','FX Future','Spot','FX Swap','IR Future','IR Future Option','IRS','Repo BD','SCF','Xccy Swap')
group by typ.M_LABEL;
------ Francois SQLs
select M_REF into MYSIMULATION_PTFREFS_TMP from TRN_PFLD_DBF where M_LABEL in('CORTO PLAZO');
select M_TRN_GTYPE, M_TRN_FMLY, M_TRN_GRP, M_TRN_TYPE,M_TYPOLOGY, count(*) from TRN_HDR_DBF where M_SRC_PFOLIO in (select M_REF from MYSIMULATION_PTFREFS_TMP) group by M_TRN_GTYPE, M_TRN_FMLY, M_TRN_GRP, M_TRN_TYPE,M_TYPOLOGY order by M_TRN_GTYPE, M_TRN_FMLY, M_TRN_GRP, M_TRN_TYPE,M_TYPOLOGY;
select M_TRN_GTYPE, M_TRN_FMLY, M_TRN_GRP, M_TRN_TYPE, count(*) from TRN_HDR_DBF where M_SRC_PFOLIO in (select M_REF from MYSIMULATION_PTFREFS_TMP) group by M_TRN_GTYPE, M_TRN_FMLY, M_TRN_GRP, M_TRN_TYPE order by M_TRN_FMLY, M_TRN_GRP, M_TRN_TYPE;
select PS_FXOPT_E.CLASSIFICATION_KEY_P, PS_FXOPT_E.SUB_CLASSIFICATION_KEY into MYSIMULATION_POS_TMP from PS_FXOPT_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP));
insert into  MYSIMULATION_POS_TMP select PS_POS_EX_E.CLASSIFICATION_KEY_P, PS_POS_EX_E.SUB_CLASSIFICATION_KEY from PS_POS_EX_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_RT_LNMOD_E.CLASSIFICATION_KEY_P, PS_RT_LNMOD_E.SUB_CLASSIFICATION_KEY from PS_RT_LNMOD_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_SBP_ADD_FLOW_E.CLASSIFICATION_KEY_P, PS_SBP_ADD_FLOW_E.SUB_CLASSIFICATION_KEY from PS_SBP_ADD_FLOW_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_SBP_TRADE_E.CLASSIFICATION_KEY_P, PS_SBP_TRADE_E.SUB_CLASSIFICATION_KEY from PS_SBP_TRADE_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_SE_COD_E.CLASSIFICATION_KEY_P, PS_SE_COD_E.SUB_CLASSIFICATION_KEY from PS_SE_COD_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_SE_CUD_E.CLASSIFICATION_KEY_P, PS_SE_CUD_E.SUB_CLASSIFICATION_KEY from PS_SE_CUD_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_TRN_CASH_E.CLASSIFICATION_KEY_P, PS_TRN_CASH_E.SUB_CLASSIFICATION_KEY from PS_TRN_CASH_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_TRN_XF_E.CLASSIFICATION_KEY_P, PS_TRN_XF_E.SUB_CLASSIFICATION_KEY from PS_TRN_XF_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
insert into  MYSIMULATION_POS_TMP select PS_FX_RISK_E.CLASSIFICATION_KEY_P, PS_FX_RISK_E.SUB_FINKEY_ID as SUB_CLASSIFICATION_KEY from PS_FX_RISK_E where (PORTFOLIO IN (select M_REF from MYSIMULATION_PTFREFS_TMP) );
select distinct CLASSIFICATION_KEY_P,SUB_CLASSIFICATION_KEY into MYSIMULATION_BUFFER_TMP from MYSIMULATION_POS_TMP;
select CLASSIFICATION_KEYS_P_DBF.M_TRN_GTYPE, MYSIMULATION_BUFFER_TMP.CLASSIFICATION_KEY_P, MYSIMULATION_BUFFER_TMP.SUB_CLASSIFICATION_KEY into MYSIMULATION_MUREXPOS_TMP from MYSIMULATION_BUFFER_TMP, CLASSIFICATION_KEYS_P_DBF where CLASSIFICATION_KEYS_P_DBF.M_CLASKEYID=MYSIMULATION_BUFFER_TMP.CLASSIFICATION_KEY_P;
select M_TRN_GTYPE, count(*) from MYSIMULATION_MUREXPOS_TMP group by M_TRN_GTYPE;
select pos.M_TRN_GTYPE,typo.TYPO_LABEL, count(*) from MYSIMULATION_MUREXPOS_TMP pos join TYPO_MAP_DBF typo on pos.M_TRN_GTYPE=typo.ID group by pos.M_TRN_GTYPE,typo.TYPO_LABEL;
---- DPI_ID_DBF
select * from DPI_ID_DBF where M_LABEL2 like '%FLD%'; 
update DPI_ID_DBF set M_UNIQUE_ID=14 where M_LABEL1 = 'STATICS' and M_LABEL2 = 'TRN_SECTOR';
---- TRN_HDR_DBF
select db_name(),count(1) from TRN_HDR_DBF;
select db_name(),TIMESTAMP,M_NB,M_MRPL_ONB,M_TRN_STATUS from TRN_HDR_DBF where M_NB in(109782,10155429,10155430,945892);
select T1.M_NB,T1.M_CONTRACT from TRN_HDR_DBF T1 join FLT_MAP_BBVA_DBF T2 on T1.M_NB=T2.M_NB where T2.M_NB=1416;
---- VRS_INFO_DBF
select * from VRS_INFO_DBF;
----TRN_DSKD_DBF
select * from TRN_DSKD_DBF;
---- Datamart related queries
select top 10 * from ACT_JOB_DBF order by M_DATE DESC;
select * from DYN_AUDIT_REP where M_OUTPUTTBL='COREPL.REP' and M_TAG_DATA='BCM';
select top 10 * from COREPL_REP where M_REF_DATA in (select M_REF_DATA from DYN_AUDIT_REP where M_OUTPUTTBL='COREPL.REP' and M_TAG_DATA='BCM');
select * from COREPL_REP where M_NB = 4502825;
---- BBVA filter tables
select * from FLT_MAP_BANCOMER_DBF where M_NB= 4502825;
select count(1) from FLT_MAP_BBVA_DBF;
---- UDF infos
select u.M_LABEL as 'Field name', case u.M_ETYPE when 1 then 'Manual' when 2 then 'List' end 'Field input type',u.M_ELABEL 'List table', l.M_STABLE as 'Systemtable', l.M_UTABLE as 'User defined structure name'
from TABLE#STRUCT#TAB_UTF_DBF u
join TABLE#STRUCT#TAB_UTH_DBF h on u.M_HEADER=h.M_REF
join TABLE#STRUCT#TAB_LNK_DBF l on h.M_LABEL=l.M_UTABLE
join TABLE#STRUCT#TAB_LNKI_DBF li on l.M_REF=li.M_REF
group by u.M_LABEL,l.M_STABLE, l.M_UTABLE order by l.M_STABLE, l.M_UTABLE, u.M_LABEL;
---- Misc

-- information about batch of feeders
select  T1.M_DATE 'exec data', T1.M_IDJOB 'job id', T1.M_PID 'mx pid', T3.M_REFERENCE 'scanner ref',
        T4.M_BAT_REF 'batch ref', 
        case T4.M_STATUS when 0 then 'waiting' when 1 then 'processing' end 'batch status',
        T1.M_BATCH 'batch', T1.M_OWNER 'usr', T1.M_GROUP 'group', 
        T2.M_STATUS 'sts', T3.M_NB_BATCHES'#batches', T3.M_NB_ITEMS '#items', T4.M_ITEMS
from ACT_JOB_DBF T1 join ACT_JOBDAP_DBF T2 on T1.M_IDJOB=T2.M_IDJOB
     join BBVA_CONVERSION_DEBUG_DM..SCANNER_REP T3 on T1.M_IDJOB=convert(int,T3.M_EXT_ID)
     join BBVA_CONVERSION_DEBUG_DM..BATCH_REP T4 on T3.M_REFERENCE=T4.M_SCANNER_ID
where T1.M_IDJOB=330;

select  dyn.M_IDJOB,dyn.M_DATEGEN,scn.M_REFERENCE, scn.M_NB_ITEMS,
        case when dyn.M_EXE_STATUS = 'T' then 'On-going' when dyn.M_EXE_STATUS = 'F' then 'Failed' end as STATUS, 
        count(*) as REMAINING, ((scn.M_NB_ITEMS - count(*))/scn.M_NB_ITEMS) * 100 as PCT_COMPLETE
from DYN_AUDIT_REP dyn join SCANNER_REP scn on convert(char,dyn.M_IDJOB) = scn.M_EXT_ID
        join BATCH_REP bat on scn.M_REFERENCE = bat.M_SCANNER_ID
        join ITEM_REP itm on itm.M_BAT_REF= bat.M_BAT_REF and itm.M_SCANNER_ID = bat.M_SCANNER_ID
group by dyn.M_IDJOB,scn.M_REFERENCE order by dyn.M_IDJOB;-- Remaining deals to be completed per batch of feeders

select dyn.M_IDJOB,dyn.M_DATEGEN,scn.M_REFERENCE, itm.M_ITM_REF
from DYN_AUDIT_REP dyn join SCANNER_REP scn on convert(char,dyn.M_IDJOB) = scn.M_EXT_ID
    join BATCH_REP bat on scn.M_REFERENCE = bat.M_SCANNER_ID
    join ITEM_REP itm on itm.M_BAT_REF= bat.M_BAT_REF and itm.M_SCANNER_ID = bat.M_SCANNER_ID
where dyn.M_IDJOB = 1306763; -- list of remaining deals to be completed per batch of feeders
select M_IDJOB, M_DATEGEN, M_DELETED, M_TAG_DATA from DYN_AUDIT_REP where M_DELETED='N' and M_TAG_DATA='BBVA'; -- get information about the audit of batch of feeders execution
-- e-tradepad information
select distinct(M_OWNER) from EBX_HDR_DBF order by M_OWNER;
select * from EBX_HDR_DBF where M_DOMAIN='e-Tradepad'and M_OWNER in ('REALTIME','MUREXFO');
select T1.M_LABEL, T1.M_DISPLAY from EBX_BOX_DBF T1, EBX_HDR_DBF T2 where T1.M_KEY=T2.M_BOXES and T2.M_OWNER='REALTIME';
select T1.M_LABEL, T1.M_DISPLAY from EBX_BOX_DBF T1 where T1.M_LABEL in ('Validation','Daily','Lookuptables','Usedmarketdata','Tradequery','Multi','OnTheFlyFXD','OnTheFly(Mid)','OnTheFly(B/A)','IRS','IRSButterfly','IRSTenorSpread','test','TEST','test2');
select * from NPD_HDR_DBF; where M_OWNER='MUREXFO' order by M_LABEL;
-- get info from STP right screen
select G.M_LABEL, PC.M_LABEL, WFT.M_TPL_LBL, STP_T.M_LABEL
from TRN_GRPD_DBF G
left join GRP_STP_DBF GRP_STP on G.M_REFERENCE = GRP_STP.M_GRP_REF
left join STP_RGH_TPL_GBL_DBF STP_T on GRP_STP.M_RIGHT_DATA = STP_T.M_REFERENCE
left join TRN_PC_DBF PC on GRP_STP.M_PC_REF = PC.M_REFERENCE
left join WFTPLRI_DBF WFT on GRP_STP.M_STP_RIGHTS = WFT.M_RIGHTS_LBL
order by G.M_LABEL;
-- get info from Portfolio rights
select G.M_GROUP, T.M_LABEL,P.M_LABEL,
case G.M_ACCESS when 0 then 'Read/Write' when 1 then 'Read only' when 2 then 'Deny' when 4 then 'Write only' end
from MUB#GRP_RGT1_DBF G
join MUB#MUB_TREE_DBF P on G.M_NODE_REF=P.M_REF
join MUB#MUB_TPL_DBF T on P.M_TRE_GROUP= T.M_TRE_GROUP and G.M_TEMPLATE=T.M_REFERENCE
order by G.M_GROUP;
-- get sql engine rights
select  R.M_GROUP 'Group', R.M_TEMPLATE 'Template', R.M_EDIT 'Allow editing mode', T.M_NAME 'Package name',
        case T.M_FLAGS when 0 then 'no rights' when 1 then 'r' when 2 then 'i' when 3 then 'r/i' when 4 then 'd'
        when 5 then 'r/d' when 6 then 'i/d' when 7 then 'r/i/d' when 8 then 'm' when 9 then 'r/m' when 10 then 'i/m'
        when 11 then 'r/i/m' when 12 then 'm/d' when 13 then 'r/m/d' when 14 then 'i/m/d' when 15 then 'r/i/m/d' end 'Rights'
from SQL_RGHT_DBF R join SQL_TMPL_DBF T on R.M_TEMPLATE=T.M_LABEL order by R.M_GROUP;
-- get CfgMgmt rights
select * from CFGT_TMPL_RIGHTS_DBF order by M_GROUP_NAME;
-- get mxml exchange rights
select GROUP_NAME,SERVICE,LABEL from XML_SERVICE_GROUPS where SERVICE in ('MXTEMPLATES', 'MXDICTIONARY', 'MXMLEXCHANGE', 'MXDECISIONRULES') order by GROUP_NAME,SERVICE,LABEL;
--misc
select db_name(),count(1) from PS_POS_EX_E;
--2.11 queries

select T1.TIMESTAMP, T1.M_IDENTITY, T1.M_NAME, T1.M_TITLE, T1.M_VERSION, T1.M_LINENUMBER, T1.M_COLNUMBER, T1.M_REFDATE, T1.M_LASTDATE, T1.M_REFYEAR, T1.M_YEARNUM, T1.M_PRECISION, T1.M_PERTYPE, T1.M_DAYINDEX from HIS_HDR_DBF T1  where  (T1.M_NAME = 'HG000017.HIS   ') ;
select T1.TIMESTAMP, T1.M_IDENTITY, T1.M_HISNAME, T1.M_LINE, T1.M_COLUMN, T1.M_NAME, T1.M_LABEL, T1.M_DEFATTR, T1.M_DEFDECIMAL, T1.M_DEFWIDTH from HIS_LNCL_DBF T1  where  (T1.M_HISNAME = 'HG000017.HIS   ')  order by T1.M_LINE asc ,T1.M_COLUMN asc ;
select T1.TIMESTAMP, T1.M_IDENTITY, T1.M_DATE16 from HG000017_HIS T1  where (T1.M_KEYNOBUF=27.) order by T1.M_LINE asc ,T1.M_COLUMN asc ,T1.M_KEYNOBUF asc ;
select T1.TIMESTAMP, T1.M_IDENTITY, T1.M_LINE, T1.M_COLUMN, T1.M_KEYNOBUF, T1.M_DATE1, T1.M_DATE2, T1.M_DATE3, T1.M_DATE4, T1.M_DATE5, T1.M_DATE6, T1.M_DATE7, T1.M_DATE8, T1.M_DATE9, T1.M_DATE10, T1.M_DATE11, T1.M_DATE12, T1.M_DATE13, T1.M_DATE14, T1.M_DATE15, T1.M_DATE16, T1.M_DATE17, T1.M_DATE18, T1.M_DATE19, T1.M_DATE20, T1.M_DATE21, T1.M_DATE22, T1.M_DATE23, T1.M_DATE24, T1.M_DATE25, T1.M_DATE26, T1.M_DATE27, T1.M_DATE28, T1.M_DATE29, T1.M_DATE30, T1.M_DATE31, T1.M_DATE32, T1.M_DATE33, T1.M_DATE34, T1.M_DATE35, T1.M_DATE36, T1.M_DATE37, T1.M_DATE38, T1.M_DATE39, T1.M_DATE40, T1.M_DATE41, T1.M_DATE42, T1.M_DATE43, T1.M_DATE44, T1.M_DATE45, T1.M_DATE46, T1.M_DATE47, T1.M_DATE48, T1.M_DATE49, T1.M_DATE50, T1.M_DATE51, T1.M_DATE52, T1.M_DATE53, T1.M_DATE54, T1.M_DATE55, T1.M_DATE56, T1.M_DATE57, T1.M_DATE58, T1.M_DATE59, T1.M_DATE60, T1.M_DATE61, T1.M_DATE62, T1.M_DATE63, T1.M_DATE64, T1.M_DATE65, T1.M_DATE66, T1.M_DATE67, T1.M_DATE68, T1.M_DATE69, T1.M_DATE70, T1.M_DATE71, T1.M_DATE72, T1.M_DATE73, T1.M_DATE74, T1.M_DATE75, T1.M_DATE76, T1.M_DATE77, T1.M_DATE78, T1.M_DATE79, T1.M_DATE80, T1.M_DATE81, T1.M_DATE82, T1.M_DATE83, T1.M_DATE84, T1.M_DATE85, T1.M_DATE86, T1.M_DATE87, T1.M_DATE88, T1.M_DATE89, T1.M_DATE90, T1.M_DATE91, T1.M_DATE92, T1.M_DATE93, T1.M_DATE94, T1.M_DATE95, T1.M_DATE96, T1.M_DATE97, T1.M_DATE98, T1.M_DATE99, T1.M_DATE100 from HG000017_HIS T1  where ((((T1.M_LINE=9.) and (T1.M_COLUMN=0.)) and (T1.M_KEYNOBUF>=23.)) and (T1.M_KEYNOBUF<=27.)) order by T1.M_KEYNOBUF asc ;
select * from TRN_BROKER_DBF where M_NB in (4863139,4863147,4863972,4865675,5468883,5471572);
select * from TRN_HDR_DBF where M_NB=5631958;
select top 10 * from TRN_CPDF_DBF where M_ID=2334;
select T1.TIMESTAMP, T1.M_IDENTITY, T1.M_NB, T1.M_LTI_NB, T1.M_GID, T1.M_NB_TISTAMP, T1.M_TRN_FMLY, T1.M_TRN_GRP, T1.M_TRN_TYPE, T1.M_TRN_GTYPE, T1.M_TRN_TYPO, T1.M_INSTRUMENT, T1.M_RSKSECTION, T1.M_PL_INSCUR, T1.M_PL_KEY1, T1.M_MKT_LABEL, T1.M_MKT_INDEX, T1.M_CNS_ACTIVE, T1.M_AGREED_TRN, T1.M_REAL, T1.M_COMMENT_BS, T1.M_CLIENT, T1.M_BINTERNAL, T1.M_BTRADER, T1.M_BPFOLIO, T1.M_BCOMMENT0, T1.M_BCOMMENT1, T1.M_BCOMMENT2, T1.M_BSTRATEGY, T1.M_BSECTION, T1.M_BENTITY, T1.M_BTRDSECT, T1.M_SINTERNAL, T1.M_STRADER, T1.M_SPFOLIO, T1.M_SCOMMENT0, T1.M_SCOMMENT1, T1.M_SCOMMENT2, T1.M_SSTRATEGY, T1.M_SSECTION, T1.M_SENTITY, T1.M_STRDSECT, T1.M_TRN_STATUS, T1.M_TRN_DATE, T1.M_TRN_TIME, T1.M_TRN_EXP, T1.M_SYS_DATE, T1.M_QTY_NB, T1.M_CREATOR, T1.M_CRE_CMMOUT, T1.M_NB_EXT, T1.M_BO_SGN, T1.M_BO_CMT, T1.M_BO_CNF, T1.M_ACC_PROR, T1.M_RPL_AMO, T1.M_RPL_AMTTYP, T1.M_RPL_AMT, T1.M_RPL_CUR, T1.M_RPL_USRDAT, T1.M_RPL_DATE1, T1.M_RPL_DATE2, T1.M_UPL_FLAG, T1.M_UPL_MODE, T1.M_UPL_AMTEVC, T1.M_UPL_AMT, T1.M_UPL_AMTDIS, T1.M_IRV_TYPE, T1.M_IRV_AMT, T1.M_FCP_REVAL, T1.M_HEDGE_FLAG, T1.M_HEDGED_ID, T1.M_HEDGED_MAT, T1.M_PAY_NET, T1.M_VAL_STATUS, T1.M_OLK, T1.M_MAIN, T1.M_FLW_SDATEF, T1.M_FLOW_FLAG, T1.M_AREA_CODE, T1.M_MRPL_FLAG, T1.M_MRPL_DATE, T1.M_MRPL_ONB, T1.M_NB_AMD, T1.M_DTE_AMD, T1.M_MOP_LAST, T1.M_MOP_CREAT, T1.M_MOP_CRSUB, T1.M_CNS_LOADFO, T1.M_BRK_THIRDP, T1.M_OPT_FLWFST, T1.M_OPT_FLWLST, T1.M_OPT_ACCLST, T1.M_OPT_MOPFST, T1.M_OPT_MOPLST, T1.M_OPT_MOPLSD, T1.M_OPT_MOPCNT, T1.M_OPT_MOP2, T1.M_OPT_MOPCOD, T1.M_OPT_MOPZON, T1.M_OPT_MOPZOA, T1.M_OPT_MOPSUB, T1.M_OPT_MOPOBS, T1.M_OPT_MOPDBS, T1.M_OPT_MOPNB, T1.M_BRW_NOM1, T1.M_BRW_NOMU1, T1.M_BRW_NOM2, T1.M_BRW_NOMU2, T1.M_BRW_RTE1, T1.M_BRW_RTE2, T1.M_BRW_MRG1, T1.M_BRW_MRG2, T1.M_BRW_STRK, T1.M_BRW_CP, T1.M_BRW_AE, T1.M_BRW_PR1, T1.M_BRW_PR2, T1.M_BRW_FV1, T1.M_BRW_FV2, T1.M_BRW_SDTE, T1.M_BRW_ODPL, T1.M_BRW_ODNC0, T1.M_BRW_ODNC1, T1.M_BRW_ODFC0, T1.M_BRW_ODFC1, T1.M_OPT_CMMNAT, T1.M_OPT_CMMDTE, T1.M_OPT_CMMCUR, T1.M_OPT_CMMSTL, T1.M_OPT_CMMSPD, T1.M_OPT_CMMSPS, T1.M_PURGE_STS, T1.M_PURGE_DATE, T1.M_PURGE_GRP, T1.M_SALES, T1.M_STS_FLAG, T1.M_LAT, T1.M_OPT_MOPVAL, T1.M_STAT_CAT, T1.M_SC_CUSTOM, T1.M_HOST_SYS, T1.M_CONTRACT, T1.M_SRC_PFOLIO, T1.M_DST_PFOLIO, T1.M_COUNTRPART, T1.M_SI_TCI, T1.M_COLLAGCAT from TRN_HDR_DBF T1  where  (T1.M_NB in (10150803,9146477))  and (((T1.M_REAL='2') or (T1.M_REAL='3')) and (((T1.M_BINTERNAL='Y') and (M_BPFOLIO in (select M_PTF_LABEL from GRP_SPTF_DBF where M_GRP_REF=1111 and M_PTF_RGT in (0, 1)))) or ((T1.M_SINTERNAL='Y') and (M_SPFOLIO in (select M_PTF_LABEL from GRP_SPTF_DBF where M_GRP_REF=1111 and M_PTF_RGT in (0, 1))))));
select top 10 M_NB, M_BCOMMENT1 from TRN_HDR_DBF where M_BCOMMENT1 <> '';
select distinct(M_BCOMMENT1) from TRN_HDR_DBF where M_BCOMMENT1 <> '';
select M_NB from TRN_HDR_DBF where M_BCOMMENT1='BSIUS_RES';

delete from TRN_HDR_DBF
where M_BPFOLIO  not in ('MX818BE','MX821BC','MX821BEBC','MX821TN','MX825HN','MX830BC','CPMDERIVA','CPMDERMN','CPCDIFWBO','CPMDIIRS','CPMSPREMX',
'CPCDIOTC','CPCGARENT','CPCVENCOR','CPMDENREG','CPMDIOTC','FOCSWANEG','FOMMCRO10','FOMMCRO15','FOMMCRO16','FOMMCRO18',
'FOMMCRO19','FOMMCRO22','FOMSWATME','FOMXEBCGL','FOMIRSMNR','FOMMCRO11','FOMMCRO14','FOMMCRO21','FOMMCRO25','FOMMCRO29',
'FOMMICRO2','FOMMICRO4','FOMMICRO5','FOMMICRO8','FOMMICRO9','FOMMIRSNC','FOMTEMPO','FOMXBCCGL','CVMRATES','CMMENERGY',
'DEMTRADIN','DGMDERIV','DGMMXEMER','DGMTASAS','DGMUDIS','LPMDIFWD','RCMDISCRE','LPMDIDEPO','LPMDIMMOO','LPMDIOTC',
'LPMDIRBAS','LPMIRS1','LPMIRS2','MKMDERIV','POMFX','LPMASIGNA','LPMDCCCME','LPMDCCEUR','LPMDCCINT','LPMDCCMXN','LPMDCCUSD',
'LPMDCNCOL','LPMDIRCUR','LPMEXDER','LPMXDERSW','MKMTRDEPO','POMIRSTIE','POMUDIMKT','POMUDIS','POCXCCY','POMINVERS','POMVALREL',
'POMXCCY','CRCTASAS','CRMCHL','CRMPEN','CRMTASAS','CRMTEMPO','DEMSWAPTI','DEMSWATOT','DEMVOLATI','DEMVOLTOT','ESMDIGTIE',
'ESMDIGTOT','ESMFLEXIC','ESMMMOO','LPMVOLTAS','LPMVOLTOT','VRMCAPCNF','VRMEXOTIC','VRMEXOTOT','DEMESTTC','DEMESTTI','ESMCOATRM',
'ESMDEPOS','ESMESTRMI','ESMESTRVA','ESMESTTAS','ESMWARRAN','FOMXTDCGL','FOMXTRCGL','FOXETDCGL','FOXETRCGL','AJUSTEVOLATIP',
'FVA_MXCRUCES','INIRDOOFF','MXCRUCDGA','MXCRUCECP','MXCRUCEDG','MXCRUCEEU','MXCRUCELP','MXCRUCENP','MXCRUCEUS','MXCRUCNPC',
'BANKING_BOOK','BB_ASIA','CORTO PLAZO','CORTO_PLAZO_CLI',
'CVA_CORTO','ETFCORTO','INIRDOCPBANK','INIRDOCPLAZO','STIR_ASIA','STIR_CNH','STIR_EUR','CRDBANCOS','CRDBTBCLP','CRDBTBCOP',
'CRDBTBPEN','CRDCHILE','CRDTASARS','INIRDOCRDMAD','FVA_COLATERAL','FVA_COLAT_BILAT','FVA_COLAT_CCP','FVA_LT_ASIA','FVA_RATES',
'FVA_RATES_ASIA','ESTRATFLOW','ESTRATGFI','INIRDOESTRAGFI','BERMUDA EUROESB','COBEXTEXO','COB_BONOS','COB_EXTERNAL','COB_EXT_TIPOS',
'CORTO NO BDT','FINP_COLAT_CRED','FINP_COLAT_RATE','FVA_NP_IR','INTERNAS_SABR','LEG_NPTIPOS','NP_COMMODITIES','NP_FOREX','OPCOTCBON',
'SLOPE_SABR','SWAPTIONAV','TRD3SPREAD','GM_GAPBONOS','GM_GAPDERIV','GM_GAPEQTY','GM_GAPWWR','SW_INI_2016','ASSET MILAN','ASSETBONOS',
'ASWGOB','BCAT TIPOS LARG','BGIPCAUX','BNACOBLAR','BOND OPT','BONOFW','BONOFWHD','BONOS FORWARD','BONOS_LINKERS','CDS_LARGO_PLAZO',
'CL LARGO','COBERPAT','CORPOIRS','CPPI_SWAPS','CVA_LARGO','DDIVIRS','ELECTRICAS','ESTRATEGIAS','ESTRATGFI_BOND','ETFDEUDA','EUROFIMA',
'FORWARD','FVA SWAPS','INDICES DEUDA','INIRDOLP','IRSCOMBI','IRSMEFF','IRSTRAD','IR_CINE','IR_STOCK','LATAM_SWAPS','LINKERS_ESP','LINKERS_ESP_H',
'LT NY','LTNY2','LT_ASIA','LT_BOND','LT_BONDH','LT_BONDT','LT_CHINA','LT_CNH','LT_HKD','LT_HKFX2','LT_HKFX_CNH','LT_HK_OPT','LT_HK_STRATEGY1','LT_KOREA',
'LT_KOREA_REPO','LT_KRW','LT_TWD','MACROBCLSW','MICROCOB','OPERPAT','PROFIT','PROJECT_GL_SW','STOCKPYME','SWACLIDIV','SWACLIINT','SWAPDIVCO',
'SWAPDIVNC','SWAPFXIRS','SWAPINTCO','SWAPINTNC','SWAPS_CVA','SWAPS_RF','SWBBVA','SWDIRFIN','SWNYBBVA','SW_BANKS','SW_CCY_BASIS','SW_COLAT_PT',
'SW_CORTO','SW_ELECTRONIC','SW_EQUITY','SW_GBP','SW_GERMANY','SW_INI_2015','SW_INSURANCE','SW_PASTORA','SW_TI','SW_TRADING_1','SW_TRADING_2',
'SW_TRADING_3','SW_TRADING_4','SW_TRADING_5','SW_TRADING_6','SW_USD','TAIWAN_FX','TAIWAN_IRS','TEMPMC02','VTABNPVMX','VTACAJAMX',
'XXBBVLPSW','ZZASSETSWAP','ZZMC02','ZZSWAPS','ZZUSA','FLOORSPV','CRDCLP','CRDCOP','CRDPEN','INIRDOSUDAM','MXCRUCECA','MXCRUCECL','MXCRUCECO',
'MXCRUCEPE','BBV BERMUDA COR','BBV CORTO','BBV CORTO MCO2','BBV DIG','BBV VANILLA','BBV VANILLAMC02','BCAT VOL INT','BDT BBV','BDT BBV MC02',
'BDT CORTO MC02','BDTBBV2','BDTBBV3','BERM USD COR','BERMUDA DOM','BNACOBVOL','BOND_INFLATION','CFCHIPOT','CHILENOS','CHILENOS BBVA',
'CL VOLAT TIPOS','CLOSE BDT BBV','CLOSE BDT MC02','COBMAXMIN','CORRELACION USD','DERCOMBI','DIG BBVA','DIG DOM','DIG EUROESB','DIGUSDBBVA',
'ESP-INFLATION','EUR-INFLATION','EXOTICAS','FIN98','FVA_INFLATION','FVA_VOL_RATES','HEDGEAV','HEDGEVIT','HIBRIDOS','HIPOTECRED',
'INIRDOVTP','LARGO NO BDT','LEGVOLATIPOS','MACROBCLVOL','OPC BONOS','OPCBDTHOJAS','OPCION COB','OPCION NC','OPCMIBOR','OPCSALES','OPTIPCFC',
'PROJECT_GL_VT','REVERFLFL','SWAPTION EURO','SWAPTION LARGO','SWAPTION USD','SWAPTIONUSDBBVA','TIPDIVCFC','UNNIM_VTIP','US-INFLATION','VOL ASSETSWAP',
'VOL-INFLATION','VOLASIA1','VOLASIA2','VOLASIA3','VOLASIA5','VOLASIA6','VOLAUD','VOLCHF','VOLCNY','VOLCNY_EXO','VOLGBP','VOLHKD','VOLHKD_2','VOLJPY',
'VOLKRW','VOLSGD','VOLTWD','VOLUSD','VTCBBVA','VTCBDTBBVA','VTCOPCBONOBBVA','VTCSWAPTIONBBVA','VTLBDTBBVA','VTLDIGBBVA','VTLVANILLABBVA',
'ZC-OPTIONS','INIRDOPD','INIRDOPD997','AAAPDFX1','AAAPDFX2','AAAPDFX3','AAAPDG01','AAAPDG02','AAAPDG04','AAAPDRV1','AAAPDRV2','AAAPDRV3','AAAPDTI1',
'AAAPDTI1B','AAAPDTI2','AAAPDTI3','PT_CREDITO','PT_FX','PT_RV','PT_SWAPS','ANALISTAS','G3','G3_EQUITY','INIRDOTRADSIST','LT_PROGRAM','NON_LIN_HF',
'UST_LOCK','UST_SPREAD','MGDSTOXAF','INIRDODISTMAD','INIRDOMIL','ASSWMIL','INIRDOOPC','INIRDODERIVNY','INIRDOUS_TREASU','NY_MANAGEMENT',
'NY_ST_DER','MAD_UST_BTB','UST_BOND','UST_STRAT','KOR_LT_SWAP','INIKORLT','VOL_IR_KOREA_1','INIRDOLTIRTPE','TWN_LTIRD2_DBU','TWN_VOLIR1_DBU',
'INIRDOVOLIRTPE','TWN_LTIRD1_DBU','LON_ESTRUCTURAS','MXCRUCDGC','INDICESG','CRDTASAS','IMVA_RATES','GM_GAPLCR','LT_HKFX1','LT_HKFX3','MGE_POS','MANAGEMENT','MANAGEMENT4')
and M_SPFOLIO not in ('MX818BE','MX821BC','MX821BEBC','MX821TN','MX825HN','MX830BC','CPMDERIVA','CPMDERMN','CPCDIFWBO','CPMDIIRS','CPMSPREMX',
'CPCDIOTC','CPCGARENT','CPCVENCOR','CPMDENREG','CPMDIOTC','FOCSWANEG','FOMMCRO10','FOMMCRO15','FOMMCRO16','FOMMCRO18',
'FOMMCRO19','FOMMCRO22','FOMSWATME','FOMXEBCGL','FOMIRSMNR','FOMMCRO11','FOMMCRO14','FOMMCRO21','FOMMCRO25','FOMMCRO29',
'FOMMICRO2','FOMMICRO4','FOMMICRO5','FOMMICRO8','FOMMICRO9','FOMMIRSNC','FOMTEMPO','FOMXBCCGL','CVMRATES','CMMENERGY',
'DEMTRADIN','DGMDERIV','DGMMXEMER','DGMTASAS','DGMUDIS','LPMDIFWD','RCMDISCRE','LPMDIDEPO','LPMDIMMOO','LPMDIOTC',
'LPMDIRBAS','LPMIRS1','LPMIRS2','MKMDERIV','POMFX','LPMASIGNA','LPMDCCCME','LPMDCCEUR','LPMDCCINT','LPMDCCMXN','LPMDCCUSD',
'LPMDCNCOL','LPMDIRCUR','LPMEXDER','LPMXDERSW','MKMTRDEPO','POMIRSTIE','POMUDIMKT','POMUDIS','POCXCCY','POMINVERS','POMVALREL',
'POMXCCY','CRCTASAS','CRMCHL','CRMPEN','CRMTASAS','CRMTEMPO','DEMSWAPTI','DEMSWATOT','DEMVOLATI','DEMVOLTOT','ESMDIGTIE',
'ESMDIGTOT','ESMFLEXIC','ESMMMOO','LPMVOLTAS','LPMVOLTOT','VRMCAPCNF','VRMEXOTIC','VRMEXOTOT','DEMESTTC','DEMESTTI','ESMCOATRM',
'ESMDEPOS','ESMESTRMI','ESMESTRVA','ESMESTTAS','ESMWARRAN','FOMXTDCGL','FOMXTRCGL','FOXETDCGL','FOXETRCGL','AJUSTEVOLATIP','FVA_MXCRUCES','INIRDOOFF','MXCRUCDGA','MXCRUCECP',
'MXCRUCEDG','MXCRUCEEU','MXCRUCELP','MXCRUCENP','MXCRUCEUS','MXCRUCNPC','BANKING_BOOK','BB_ASIA','CORTO PLAZO','CORTO_PLAZO_CLI',
'CVA_CORTO','ETFCORTO','INIRDOCPBANK','INIRDOCPLAZO','STIR_ASIA','STIR_CNH','STIR_EUR','CRDBANCOS','CRDBTBCLP','CRDBTBCOP',
'CRDBTBPEN','CRDCHILE','CRDTASARS','INIRDOCRDMAD','FVA_COLATERAL','FVA_COLAT_BILAT','FVA_COLAT_CCP','FVA_LT_ASIA','FVA_RATES',
'FVA_RATES_ASIA','ESTRATFLOW','ESTRATGFI','INIRDOESTRAGFI','BERMUDA EUROESB','COBEXTEXO','COB_BONOS','COB_EXTERNAL','COB_EXT_TIPOS',
'CORTO NO BDT','FINP_COLAT_CRED','FINP_COLAT_RATE','FVA_NP_IR','INTERNAS_SABR','LEG_NPTIPOS','NP_COMMODITIES','NP_FOREX','OPCOTCBON',
'SLOPE_SABR','SWAPTIONAV','TRD3SPREAD','GM_GAPBONOS','GM_GAPDERIV','GM_GAPEQTY','GM_GAPWWR','SW_INI_2016','ASSET MILAN','ASSETBONOS',
'ASWGOB','BCAT TIPOS LARG','BGIPCAUX','BNACOBLAR','BOND OPT','BONOFW','BONOFWHD','BONOS FORWARD','BONOS_LINKERS','CDS_LARGO_PLAZO',
'CL LARGO','COBERPAT','CORPOIRS','CPPI_SWAPS','CVA_LARGO','DDIVIRS','ELECTRICAS','ESTRATEGIAS','ESTRATGFI_BOND','ETFDEUDA','EUROFIMA',
'FORWARD','FVA SWAPS','INDICES DEUDA','INIRDOLP','IRSCOMBI','IRSMEFF','IRSTRAD','IR_CINE','IR_STOCK','LATAM_SWAPS','LINKERS_ESP','LINKERS_ESP_H',
'LT NY','LTNY2','LT_ASIA','LT_BOND','LT_BONDH','LT_BONDT','LT_CHINA','LT_CNH','LT_HKD','LT_HKFX2','LT_HKFX_CNH','LT_HK_OPT','LT_HK_STRATEGY1','LT_KOREA',
'LT_KOREA_REPO','LT_KRW','LT_TWD','MACROBCLSW','MICROCOB','OPERPAT','PROFIT','PROJECT_GL_SW','STOCKPYME','SWACLIDIV','SWACLIINT','SWAPDIVCO',
'SWAPDIVNC','SWAPFXIRS','SWAPINTCO','SWAPINTNC','SWAPS_CVA','SWAPS_RF','SWBBVA','SWDIRFIN','SWNYBBVA','SW_BANKS','SW_CCY_BASIS','SW_COLAT_PT',
'SW_CORTO','SW_ELECTRONIC','SW_EQUITY','SW_GBP','SW_GERMANY','SW_INI_2015','SW_INSURANCE','SW_PASTORA','SW_TI','SW_TRADING_1','SW_TRADING_2',
'SW_TRADING_3','SW_TRADING_4','SW_TRADING_5','SW_TRADING_6','SW_USD','TAIWAN_FX','TAIWAN_IRS','TEMPMC02','VTABNPVMX','VTACAJAMX',
'XXBBVLPSW','ZZASSETSWAP','ZZMC02','ZZSWAPS','ZZUSA','FLOORSPV','CRDCLP','CRDCOP','CRDPEN','INIRDOSUDAM','MXCRUCECA','MXCRUCECL','MXCRUCECO',
'MXCRUCEPE','BBV BERMUDA COR','BBV CORTO','BBV CORTO MCO2','BBV DIG','BBV VANILLA','BBV VANILLAMC02','BCAT VOL INT','BDT BBV','BDT BBV MC02',
'BDT CORTO MC02','BDTBBV2','BDTBBV3','BERM USD COR','BERMUDA DOM','BNACOBVOL','BOND_INFLATION','CFCHIPOT','CHILENOS','CHILENOS BBVA',
'CL VOLAT TIPOS','CLOSE BDT BBV','CLOSE BDT MC02','COBMAXMIN','CORRELACION USD','DERCOMBI','DIG BBVA','DIG DOM','DIG EUROESB','DIGUSDBBVA',
'ESP-INFLATION','EUR-INFLATION','EXOTICAS','FIN98','FVA_INFLATION','FVA_VOL_RATES','HEDGEAV','HEDGEVIT','HIBRIDOS','HIPOTECRED',
'INIRDOVTP','LARGO NO BDT','LEGVOLATIPOS','MACROBCLVOL','OPC BONOS','OPCBDTHOJAS','OPCION COB','OPCION NC','OPCMIBOR','OPCSALES','OPTIPCFC',
'PROJECT_GL_VT','REVERFLFL','SWAPTION EURO','SWAPTION LARGO','SWAPTION USD','SWAPTIONUSDBBVA','TIPDIVCFC','UNNIM_VTIP','US-INFLATION','VOL ASSETSWAP',
'VOL-INFLATION','VOLASIA1','VOLASIA2','VOLASIA3','VOLASIA5','VOLASIA6','VOLAUD','VOLCHF','VOLCNY','VOLCNY_EXO','VOLGBP','VOLHKD','VOLHKD_2','VOLJPY',
'VOLKRW','VOLSGD','VOLTWD','VOLUSD','VTCBBVA','VTCBDTBBVA','VTCOPCBONOBBVA','VTCSWAPTIONBBVA','VTLBDTBBVA','VTLDIGBBVA','VTLVANILLABBVA',
'ZC-OPTIONS','INIRDOPD','INIRDOPD997','AAAPDFX1','AAAPDFX2','AAAPDFX3','AAAPDG01','AAAPDG02','AAAPDG04','AAAPDRV1','AAAPDRV2','AAAPDRV3','AAAPDTI1',
'AAAPDTI1B','AAAPDTI2','AAAPDTI3','PT_CREDITO','PT_FX','PT_RV','PT_SWAPS','ANALISTAS','G3','G3_EQUITY','INIRDOTRADSIST','LT_PROGRAM','NON_LIN_HF',
'UST_LOCK','UST_SPREAD','MGDSTOXAF','INIRDODISTMAD','INIRDOMIL','ASSWMIL','INIRDOOPC','INIRDODERIVNY','INIRDOUS_TREASU','NY_MANAGEMENT',
'NY_ST_DER','MAD_UST_BTB','UST_BOND','UST_STRAT','KOR_LT_SWAP','INIKORLT','VOL_IR_KOREA_1','INIRDOLTIRTPE','TWN_LTIRD2_DBU','TWN_VOLIR1_DBU',
'INIRDOVOLIRTPE','TWN_LTIRD1_DBU','LON_ESTRUCTURAS','MXCRUCDGC','INDICESG','CRDTASAS','IMVA_RATES','GM_GAPLCR','LT_HKFX1','LT_HKFX3','MGE_POS','MANAGEMENT','MANAGEMENT4');

insert TRN_HDR_DBF_NOPJ01(TIMESTAMP,M_NB,M_GID,M_TRN_FMLY,M_TRN_GRP,M_TRN_TYPE,M_TRN_GTYPE,M_TRN_TYPO,M_INSTRUMENT,M_RSKSECTION,M_PL_INSCUR,M_PL_KEY1,M_MKT_LABEL,M_MKT_INDEX,M_CNS_ACTIVE,M_COMMENT_BS,M_CLIENT,M_BINTERNAL,M_BTRADER,M_BPFOLIO,M_BCOMMENT0,M_BCOMMENT1,M_BCOMMENT2,M_BSTRATEGY,M_BSECTION,M_BENTITY,M_SINTERNAL,M_STRADER,M_SPFOLIO,M_SCOMMENT0,M_SCOMMENT1,M_SCOMMENT2,M_SSTRATEGY,M_SSECTION,M_SENTITY,M_TRN_STATUS,M_TRN_DATE,M_TRN_TIME,M_TRN_EXP,M_SYS_DATE,M_CREATOR,M_CRE_CMMOUT,M_NB_EXT,M_ACC_PROR,M_RPL_AMO,M_RPL_AMTTYP,M_RPL_AMT,M_RPL_CUR,M_RPL_USRDAT,M_RPL_DATE1,M_RPL_DATE2,M_UPL_FLAG,M_UPL_MODE,M_UPL_AMTEVC,M_UPL_AMT,M_UPL_AMTDIS,M_IRV_TYPE,M_IRV_AMT,M_FCP_REVAL,M_HEDGE_FLAG,M_HEDGED_ID,M_HEDGED_MAT,M_PAY_NET,M_VAL_STATUS,M_MAIN,M_FLOW_FLAG,M_AREA_CODE,M_MRPL_DATE,M_MRPL_ONB,M_CAN_GXIT,M_GXIT_DATE,M_MOP_LAST,M_BRK_THIRDP,M_OPT_FLWFST,M_OPT_FLWLST,M_OPT_ACCLST,M_OPT_MOPFST,M_OPT_MOPLST,M_OPT_MOPCNT,M_OPT_MOPNB,M_BRW_NOM1,M_BRW_NOMU1,M_BRW_NOM2,M_BRW_NOMU2,M_BRW_RTE1,M_BRW_RTE2,M_BRW_MRG1,M_BRW_MRG2,M_BRW_STRK,M_BRW_CP,M_BRW_AE,M_BRW_PR1,M_BRW_PR2,M_BRW_FV1,M_BRW_FV2,M_BRW_SDTE,M_BRW_ODPL,M_BRW_ODNC0,M_BRW_ODNC1,M_BRW_ODFC0,M_BRW_ODFC1,M_OPT_CMMNAT,M_OPT_CMMDTE,M_OPT_CMMCUR,M_OPT_CMMSTL,M_OPT_CMMSPD,M_OPT_CMMSPS,M_PURGE_DATE,M_SALES,M_LAT,M_HOST_SYS,M_CNT_INTID,M_CONTRACT,M_OPT_NATURE,M_ORIG_PS_ID,M_PS_ID,M_STAT_CAT,M_CUSTOM,M_COMP_TYPO,M_TYPOLOGY,M_USAGE,M_ONS_OFFS,M_SETTL_METH,M_P_ENTITY,M__DT_TS,M_OPT_STSVER,M_PURGE_REF,M_SRC_PFOLIO,M_DST_PFOLIO,M_COUNTRPART,M_PURPOSE,M_BLENTITY,M_SLENTITY,M_SI_TCI,M_COLLAGCAT,M_LEXTREF,M_LEVTEXTREF,M_LIMPEXTREF,M_B_STG_NODE,M_S_STG_NODE,M_PRC_CTP)
select TIMESTAMP,M_NB,M_GID,M_TRN_FMLY,M_TRN_GRP,M_TRN_TYPE,M_TRN_GTYPE,M_TRN_TYPO,M_INSTRUMENT,M_RSKSECTION,M_PL_INSCUR,M_PL_KEY1,M_MKT_LABEL,M_MKT_INDEX,M_CNS_ACTIVE,M_COMMENT_BS,M_CLIENT,M_BINTERNAL,M_BTRADER,M_BPFOLIO,M_BCOMMENT0,M_BCOMMENT1,M_BCOMMENT2,M_BSTRATEGY,M_BSECTION,M_BENTITY,M_SINTERNAL,M_STRADER,M_SPFOLIO,M_SCOMMENT0,M_SCOMMENT1,M_SCOMMENT2,M_SSTRATEGY,M_SSECTION,M_SENTITY,M_TRN_STATUS,M_TRN_DATE,M_TRN_TIME,M_TRN_EXP,M_SYS_DATE,M_CREATOR,M_CRE_CMMOUT,M_NB_EXT,M_ACC_PROR,M_RPL_AMO,M_RPL_AMTTYP,M_RPL_AMT,M_RPL_CUR,M_RPL_USRDAT,M_RPL_DATE1,M_RPL_DATE2,M_UPL_FLAG,M_UPL_MODE,M_UPL_AMTEVC,M_UPL_AMT,M_UPL_AMTDIS,M_IRV_TYPE,M_IRV_AMT,M_FCP_REVAL,M_HEDGE_FLAG,M_HEDGED_ID,M_HEDGED_MAT,M_PAY_NET,M_VAL_STATUS,M_MAIN,M_FLOW_FLAG,M_AREA_CODE,M_MRPL_DATE,M_MRPL_ONB,M_CAN_GXIT,M_GXIT_DATE,M_MOP_LAST,M_BRK_THIRDP,M_OPT_FLWFST,M_OPT_FLWLST,M_OPT_ACCLST,M_OPT_MOPFST,M_OPT_MOPLST,M_OPT_MOPCNT,M_OPT_MOPNB,M_BRW_NOM1,M_BRW_NOMU1,M_BRW_NOM2,M_BRW_NOMU2,M_BRW_RTE1,M_BRW_RTE2,M_BRW_MRG1,M_BRW_MRG2,M_BRW_STRK,M_BRW_CP,M_BRW_AE,M_BRW_PR1,M_BRW_PR2,M_BRW_FV1,M_BRW_FV2,M_BRW_SDTE,M_BRW_ODPL,M_BRW_ODNC0,M_BRW_ODNC1,M_BRW_ODFC0,M_BRW_ODFC1,M_OPT_CMMNAT,M_OPT_CMMDTE,M_OPT_CMMCUR,M_OPT_CMMSTL,M_OPT_CMMSPD,M_OPT_CMMSPS,M_PURGE_DATE,M_SALES,M_LAT,M_HOST_SYS,M_CNT_INTID,M_CONTRACT,M_OPT_NATURE,M_ORIG_PS_ID,M_PS_ID,M_STAT_CAT,M_CUSTOM,M_COMP_TYPO,M_TYPOLOGY,M_USAGE,M_ONS_OFFS,M_SETTL_METH,M_P_ENTITY,M__DT_TS,M_OPT_STSVER,M_PURGE_REF,M_SRC_PFOLIO,M_DST_PFOLIO,M_COUNTRPART,M_PURPOSE,M_BLENTITY,M_SLENTITY,M_SI_TCI,M_COLLAGCAT,M_LEXTREF,M_LEVTEXTREF,M_LIMPEXTREF,M_B_STG_NODE,M_S_STG_NODE,M_PRC_CTP 
from TRN_HDR_DBF where M_NB in 
(6418225,1139031,2123213,2123214,2154490,2154491,2168198,2168199,2224091,2224092,2326681,2326682,2343378,2343392,2343400,2343408,2345329,2345331,2357243,2357248,2418954,2469078,2486951,2509363,2509371,2540380,2557657,2557663,2592872,2592876,2592889,2592891,2612714,2612716,2612717,2612718,2641057,2667260,3507067,3507100,3580931,3580941,3603132,3603148,6418223,7945803,7945805,7945807,7945814,8092691,8092698,8092707,8092708);
delete from TRN_HDR_DBF
where M_NB in 
(6418225,1139031,2123213,2123214,2154490,2154491,2168198,2168199,2224091,2224092,2326681,2326682,2343378,2343392,2343400,2343408,2345329,2345331,2357243,2357248,2418954,2469078,2486951,2509363,2509371,2540380,2557657,2557663,2592872,2592876,2592889,2592891,2612714,2612716,2612717,2612718,2641057,2667260,3507067,3507100,3580931,3580941,3603132,3603148,6418223,7945803,7945805,7945807,7945814,8092691,8092698,8092707,8092708);

--
select top 100 * from PS_POS_EX_E where CLASSIFICATION_KEY_P=20834;
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_FXOPT_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_POS_EX_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') and pos.CNS_ACTIVE=1  group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_RT_LNMOD_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_SBP_ADD_FLOW_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_SBP_TRADE_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_SE_COD_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_SE_CUD_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_TRN_CASH_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY,typ.M_LABEL from PS_TRN_XF_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_CLASSIFICATION_KEY, typ.M_LABEL
union all
select pos.CLASSIFICATION_KEY_P, pos.SUB_FINKEY_ID,typ.M_LABEL from PS_FX_RISK_E pos join CLASSIFICATION_KEYS_P_DBF k on pos.CLASSIFICATION_KEY_P = k.M_CLASKEYID join CLASS_ID_DBF cls on k.M_CLASSID = cls.M_FIN_ID  join TYPOLOGY_DBF typ on cls.M_TYPO=typ.M_REFERENCE join TRN_PFLD_DBF p on cls.M_PORTFOLIO=p.M_REF where p.M_LABEL in ('CORTO PLAZO') group by pos.CLASSIFICATION_KEY_P, pos.SUB_FINKEY_ID, typ.M_LABEL;